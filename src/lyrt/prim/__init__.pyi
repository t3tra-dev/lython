from __future__ import annotations

from typing import Generic, List, Type, TypeVar, TypeVarTuple, Unpack

__all__ = [
    "Prim",
    "Int",
    "Float",
    "Vector",
    "Matrix",
    "Tensor",
]

PrimT = TypeVar("PrimT", bound=Prim[Int] | Prim[Float])

class Prim(Generic[PrimT]):
    """Base class for all primitive types"""

    def __add__(self: PrimT, other: PrimT) -> PrimT: ...
    def __sub__(self: PrimT, other: PrimT) -> PrimT: ...
    def __mul__(self: PrimT, other: PrimT) -> PrimT: ...
    def __div__(self: PrimT, other: PrimT) -> PrimT: ...
    def __neg__(self: PrimT) -> PrimT: ...
    def __lt__(self: PrimT, other: PrimT) -> Int[1]: ...
    def __le__(self: PrimT, other: PrimT) -> Int[1]: ...
    def __eq__(self: PrimT, other: PrimT) -> Int[1]: ...  # type: ignore
    def __ne__(self: PrimT, other: PrimT) -> Int[1]: ...  # type: ignore
    def __gt__(self: PrimT, other: PrimT) -> Int[1]: ...
    def __ge__(self: PrimT, other: PrimT) -> Int[1]: ...

IntT = TypeVar("IntT", bound=PrimInt)
FloatT = TypeVar("FloatT", bound=PrimFloat)

class PrimInt(Generic[IntT], Prim[IntT]):
    """Intermediate class for integer primitives"""

    def __mod__(self: IntT, other: IntT) -> PrimInt[IntT]: ...

class PrimFloat(Generic[FloatT], Prim[FloatT]):
    """Intermediate class for floating-point primitives"""

    def __truediv__(self: FloatT, other: FloatT) -> PrimFloat[FloatT]: ...
    def __floordiv__(self: FloatT, other: FloatT) -> PrimFloat[FloatT]: ...

class Int(PrimInt[Int]):
    """Integer primitive type"""

    def __class_getitem__(cls, key: int) -> Type[Int]: ...
    def __init__(self, value: int) -> None: ...

class Float(PrimFloat[Float]):
    """Floating-point primitive type"""

    def __class_getitem__(cls, key: int) -> Type[Float]: ...
    def __init__(self, value: int | float) -> None: ...

type NumberLike = Prim[Int | Float] | int | float

Shape = TypeVarTuple("Shape")

class Vector:
    def __class_getitem__(cls, key: tuple[Prim[Int | Float], int]) -> Type[Vector]: ...
    def __init__(self, value: List[NumberLike]) -> None: ...
    @classmethod
    def zeros(cls) -> Vector: ...
    @classmethod
    def ones(cls) -> Vector: ...
    @classmethod
    def full(cls, value: NumberLike) -> Vector: ...

class Matrix:
    def __class_getitem__(
        cls, key: tuple[Prim[Int | Float], int, int]
    ) -> Type[Matrix]: ...
    def __init__(self, value: List[List[NumberLike]]) -> None: ...
    @classmethod
    def zeros(cls) -> Matrix: ...
    @classmethod
    def ones(cls) -> Matrix: ...
    @classmethod
    def full(cls, value: NumberLike) -> Matrix: ...

class Tensor:
    def __class_getitem__(
        cls, key: tuple[Prim[Int | Float], Unpack[Shape]]
    ) -> Type[Tensor]: ...

    type _NestedNumberLike = NumberLike | List[_NestedNumberLike]
    def __init__(self, value: _NestedNumberLike) -> None: ...
    @classmethod
    def zeros(cls) -> Tensor: ...
    @classmethod
    def ones(cls) -> Tensor: ...
    @classmethod
    def full(cls, value: NumberLike) -> Tensor: ...
